<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
 <mapper namespace="reserves">
 
  	<select id="insert" resultType="int" parameterType="mybatis.vo.Reserve">
 		INSERT INTO TBL_RESERVE
  		VALUES(reserve_idx_seq.nextval, #{member_code}, #{theater}, #{movie_code}, sysdate ,#{scheduleDate}, #{seat})
 	</select>
 	<select id="delete" resultType="int" parameterType="java.util.Map">
 		DELETE FROM TBL_RESERVE
		WHERE RCODE=#{rcode} AND MEMBER_CODE= #{member_code} 
 	</select>

 	<select id="reserveAll" parameterType="String" resultType="mybatis.vo.ReserveList">
 		SELECT TR.MEMBER_CODE, TM.MNAME , TR.SCHEDULE , TR.RESERVE_DATE, TM.RATING, TC.NAME ,TR.RCODE, TR.SEAT 
		FROM TBL_MOVIE tm , TBL_RESERVE tr, TBL_CINEMA tc 
		WHERE TM.MCODE = TR.MOVIE_CODE
		AND TR.MEMBER_CODE = #{member_code}
 	</select>
 	<select id="reserve" parameterType="java.util.Map" resultType="mybatis.vo.ReserveList">
 		SELECT TR.MEMBER_CODE, TM.MNAME , TR.SCHEDULE , TR.RESERVE_DATE, TM.RATING, TC.NAME ,TR.RCODE, TR.SEAT 
		FROM TBL_MOVIE tm , TBL_RESERVE tr, TBL_CINEMA tc 
		WHERE TM.MCODE = TR.MOVIE_CODE
		AND TR.MEMBER_CODE = #{member_code}
		AND tr.MOVIE_CODE =#{movie_code}
		AND TO_CHAR(TR.RESERVE_DATE,'YYYY-MM-DD')=TO_CHAR(SYSDATE,'YYYY-MM-DD')
 	</select>
 
 
 
 </mapper>
 
 
 
 
 
 